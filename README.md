# KumaDocReport - Uptime Kuma 监控报告生成工具

一个专为 **Uptime Kuma** 设计的自动化 Word 监控报告生成工具，一键生成规范、正式、可直接交付的网站监测服务报告，支持多时间维度与批量监控项分析。

## 📚 目录

- [✨ 功能亮点](#✨ 功能亮点)
- [📸 报告预览](#📸 报告预览)
- [📦 依赖安装](#📦 依赖安装)
- [🚀 快速使用](#🚀 快速使用)
- [📁 配置文件](#📁 配置文件)
- [📋 报告内容说明](#📋 报告内容说明)
- [📊 统计指标](#📊 统计指标)
- [⚠️ 注意事项](#⚠️ 注意事项)
- [❓ 常见问题](#❓ 常见问题)

## ✨ 功能亮点

- 🔗 **无缝对接 Uptime Kuma**：自动拉取监控项、心跳数据、停机事件、响应延迟，无需手动导出
- 📅 **多时间维度支持**：一键生成日报、周报、月报、季度报、年报，适配不同交付场景
- 👥 **监控组智能识别**：自动区分监控组与单独监控项，支持多选批量生成，监控组自动包含子监控
- 📄 **标准化 Word 输出**：内置企业级文档样式（封面、页眉、表格、标题层级），可直接交付客户
- ⚙️ **配置自动保存**：首次输入后，自动保存 Uptime Kuma 地址、账号、公司信息至配置文件，无需重复输入
- 🔍 **精细化数据分析**：支持停机事件时间线、关键词触发统计、延迟波动分析
- 🎨 **自定义适配**：支持替换 Logo、调整文档样式、修改报告文案，适配企业品牌规范

## 📸 报告预览

生成的 Word 报告符合企业交付规范，以下为核心页面模拟截图（实际效果以生成文档为准）：

### 1. 报告封面

包含公司中英文全称、报告类型（如月报）、生成日期，格式居中对齐，贴合企业正式文档规范。

示例：左侧 Logo + 中间报告标题（一号黑体） + 底部公司中英文全称（分散对齐）

### 2. 综述信息页

包含监测概述、监测对象表格，清晰列出所有选中的监控项名称及访问地址，格式规范统一。

### 3. 监控详情页

以表格形式展示各周期（日/周/月）的停机次数、平均停机时长、平均延迟、最大延迟、停机占比，一目了然。

### 4. 停机事件日志

倒序展示所有停机事件，包含停机开始时间、持续时长，持续中的停机将标注“持续中”。

### 5. 总结与建议页

自动生成监控结果总结、修复优化建议、下一步监测计划，无需手动编写，直接复用。

## 📦 依赖安装

克隆项目后，执行以下命令安装依赖：

```bash
# 克隆项目（可选，若直接下载无需执行）
git clone https://github.com/freedom2599/kumaDocReport.git
cd kumaDocReport

# 安装依赖
pip install -r requirements.txt
    
```

**requirements.txt 详情**（自动适配项目技术栈）：

```txt
python-docx>=0.8.11  # Word文档生成
PyYAML>=6.0          # 配置文件解析
pytz>=2024.1         # 时区处理
uptime-kuma-api>=1.0.0  # Uptime Kuma API对接
    
```

## 🚀 快速使用

### 1. 运行程序

```bash
python3 main.py
```

### 2. 首次运行引导

首次运行将提示输入以下信息（输入后自动保存至 config.yml，下次无需重复输入）：

- Uptime Kuma 地址（示例：http://192.168.181.132:3001）
- Uptime Kuma 用户名
- Uptime Kuma 密码（密码输入不显示，保障安全）
- 公司中文全称（示例：XXXX网络安全技术有限公司）
- 公司英文全称（示例：XXXXX XXXXX Cybersecurity Technology Co., Ltd.）

### 3. 选择监控项

程序将列出所有 Uptime Kuma 中的顶级监控项（监控组/单独监控），输入编号选择：

- 单选：直接输入编号（如 1）
- 多选：编号用逗号分隔（如 1,3,5）
- 监控组：选择监控组编号后，自动包含其下所有子监控项

### 4. 选择报告类型

```text
📊 请选择报告类型：
   [1] 日报（按天统计）（可输入关键词：day）
   [2] 周报（按周统计）（可输入关键词：week）
   [3] 月报（按月统计）（可输入关键词：month）
   [4] 季度报告(按季度统计)（可输入关键词：quarter）
   [5] 年报(按年统计)（可输入关键词：year）
请输入编号/关键词（默认3=月报）：
    
```

### 5. 生成报告

程序自动分析监控数据、生成 Word 报告，生成成功后将提示文件路径，文件自动命名（示例）：

```text
✅ Word报告生成成功: XXXX网站检测服务月报_20260212_153022.docx
    
```

## 📁 配置文件

配置文件为 `config.yml`，自动生成于项目根目录，可手动修改，无需重新运行引导：

```yaml
# 配置文件示例（自动保存，手动修改生效）
url: http://192.168.181.132:3001  # Uptime Kuma 地址
username: admin                   # Uptime Kuma 用户名
Company: "\u6D4B\u8BD5"  # 公司中文全称的Unicode 转义序列
Company_English_name: "XXXXX XXXX Cybersecurity Technology Co., Ltd."  # 公司英文全称
    
```

## 📋 报告内容说明

生成的 Word 报告包含以下核心模块，全程自动化填充，无需手动编辑：

1. **封面**：Logo + 报告标题（如“XXXX网站检测服务月报”） + 公司中英文全称 + 生成日期
2. **页眉**：左侧项目 Logo + 右侧报告名称（“网站监测服务报告”），全局统一
3. **综述信息**
   1. 监测概述：说明监测目的、范围（可用性、内容合规）、告警机制
   2. 监测对象：表格展示选中的所有监控项名称、访问地址
   3. 注意事项：说明监测受限因素（如 WAF 拦截、认证页面访问限制）
4. **监测结果**
   1. 监控项目总览（仅当选择监控组时显示）
   2. 各监控项详情：统计表格 + 关键词日志 + 停机事件日志
5. **监控结果总结**
   1. 结果概述：可用性、内容合规性整体评价
   2. 修复优化建议：可用性、内容合规、保障措施三类建议
   3. 下一步监测计划：优化监控策略、扩大覆盖范围等

## 📊 统计指标

报告中自动计算并展示以下核心统计指标，支持日/周/月三个维度对比：

| 统计指标     | 说明                                            |
| :----------- | :---------------------------------------------- |
| 停机次数     | 指定周期内监控项的停机总次数                    |
| 平均停机时长 | 所有停机事件的平均持续时间（格式：d h m s）     |
| 平均延迟     | 指定周期内监控项的平均响应延迟（单位：ms）      |
| 最大延迟     | 指定周期内监控项的最大响应延迟（单位：ms）      |
| 停机占比     | 停机总时长占该周期总时长的百分比（保留2位小数） |
| 关键词相关   | 关键词触发次数、唯一关键词列表、触发占比        |

## ⚠️ 注意事项

- 🖼️ Logo 路径：项目根目录需存在 `./logo/logo.png`，可替换为自身企业 Logo，宽度自动适配
- 🔗 连接要求：确保运行环境可正常访问 Uptime Kuma 地址，且账号密码正确
- 📈 数据要求：监控项需有历史心跳数据，否则无法生成统计指标（无数据将显示 N/A）
- 📄 文档兼容：生成的 Word 文档兼容 Microsoft Word 2016+、WPS 等主流文档编辑器

## ❓ 常见问题

### Q1: 运行报错 “yaml.safe_load(f) 失败”？

A: 检查 config.yml 格式是否正确（冒号后加空格、不使用 Tab 缩进），或删除 config.yml 重新运行程序，重新输入配置。

### Q2: 生成的报告中无监控数据，显示 N/A？

A: 检查监控项是否有历史心跳数据，或调整报告类型（如选择日报，确保当天有监控数据）。

### Q3: 无法选择监控组下的子监控项？

A: 程序自动识别监控组，选择监控组编号后，将自动包含其下所有子监控项，无需单独选择子项。

### Q4: 报告字体、格式不符合需求？

A: 可修改 main.py 中 “Word报告生成核心函数” 内的样式配置（字体、字号、行距、表格样式等）。

## 📌 补充说明

- 版本：v2.0.0

      - 用途：Uptime Kuma 监控数据自动化分析与 Word 报告生成
      
          - 适配场景：企业内部监控复盘、客户交付报告、日常运维总结
      
          - 扩展建议：可根据需求修改报告文案、添加企业水印、新增统计指标

✨ 如有问题，欢迎提交 Issue 或联系开发人员反馈！